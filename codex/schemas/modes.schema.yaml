$schema: "https://json-schema.org/draft/2020-12/schema"
title: Eudaimonia Mode Schema
type: object
required: [version, name, trace, cot]
properties:
  version: { type: number, minimum: 0.1 }
  name: { type: string, enum: [default, empathy, guardian] }
  stance: { type: string }
  trace: { type: boolean }
  socratic_ratio: { type: string, pattern: "^[0-9]{1,3}/[0-9]{1,3}$" }
  presentation:
    type: object
    properties:
      answer_style: { type: string, enum: [socratic_then_concise, direct_only] }
      direct_override: { type: string }
    additionalProperties: true
  routing:
    type: object
    properties:
      tau: { type: number, minimum: 0, maximum: 1 }
      gap_domains:
        type: array
        items: { type: string, enum: [general_knowledge, news, pop_culture, healthcare, coding, analysis] }
        uniqueItems: true
    additionalProperties: true
  guardian:
    type: object
    properties:
      fuse: { type: integer, minimum: 0 }
    additionalProperties: true
  actions:
    type: object
    properties:
      low:    { type: string, enum: [cautious_answer] }
      medium: { type: string, enum: [reframe] }
      high:   { type: string, enum: [refuse_with_reason] }
    additionalProperties: false
  logging_fields:
    type: array
    items: { type: string, enum: [risk_level, reason_codes, fuse_count] }
    uniqueItems: true
  prompts:
    type: object
    properties:
      growth_nudger:
        type: object
        properties: { text: { type: string } }
        required: [text]
        additionalProperties: false
      disclaimers:
        type: array
        items: { type: string }
    additionalProperties: true
  cot:
    type: object
    required: [steps]
    properties:
      steps:
        type: array
        minItems: 1
        items:
          type: string
          enum:
            - scope_and_gap_check
            - decompose
            - reason
            - present
            - escalation_hint
            - detect_emotion
            - validate
            - clarify
            - reflect
            - offer_support
            - growth_nudger_optional
            - state_trigger
            - explain_analysis
            - conclude_and_act
    additionalProperties: false
additionalProperties: true